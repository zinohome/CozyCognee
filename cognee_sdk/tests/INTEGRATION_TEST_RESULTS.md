# æœåŠ¡å™¨é›†æˆæµ‹è¯•ç»“æœ

## âœ… å·²é€šè¿‡çš„æµ‹è¯•

ä½¿ç”¨æä¾›çš„ API Tokenï¼Œä»¥ä¸‹æµ‹è¯•å·²æˆåŠŸé€šè¿‡ï¼š

### åŸºç¡€åŠŸèƒ½æµ‹è¯•

1. **test_server_health_check** âœ…
   - æœåŠ¡å™¨å¥åº·æ£€æŸ¥
   - çŠ¶æ€ï¼šready
   - ç‰ˆæœ¬ï¼š0.4.1-local

2. **test_list_datasets** âœ…
   - åˆ—å‡ºæ‰€æœ‰æ•°æ®é›†
   - æˆåŠŸè·å–æ•°æ®é›†åˆ—è¡¨

3. **test_create_dataset** âœ…
   - åˆ›å»ºæ•°æ®é›†
   - æˆåŠŸåˆ›å»ºå¹¶è¿”å›æ•°æ®é›†ä¿¡æ¯

4. **test_delete_dataset** âœ…
   - åˆ é™¤æ•°æ®é›†
   - æˆåŠŸåˆ é™¤æ•°æ®é›†

## âš ï¸ éœ€è¦è¿›ä¸€æ­¥è°ƒè¯•çš„æµ‹è¯•

ä»¥ä¸‹æµ‹è¯•è¿”å› 500 æœåŠ¡å™¨é”™è¯¯ï¼Œå¯èƒ½æ˜¯æœåŠ¡å™¨ç«¯é…ç½®æˆ– API æ ¼å¼é—®é¢˜ï¼š

### æ•°æ®æ“ä½œæµ‹è¯•

1. **test_add_data** âš ï¸
   - é”™è¯¯ï¼š500 Internal Server Error
   - å¯èƒ½åŸå› ï¼šæœåŠ¡å™¨ç«¯å¤„ç† multipart/form-data æ—¶å‡ºç°é—®é¢˜

2. **test_add_multiple_data** âš ï¸
   - é”™è¯¯ï¼š500 Internal Server Error
   - ä¾èµ–ï¼štest_add_data

3. **test_update_data** âš ï¸
   - é”™è¯¯ï¼š500 Internal Server Error
   - ä¾èµ–ï¼šéœ€è¦å…ˆæˆåŠŸæ·»åŠ æ•°æ®

4. **test_delete_data** âš ï¸
   - é”™è¯¯ï¼š500 Internal Server Error
   - ä¾èµ–ï¼šéœ€è¦å…ˆæˆåŠŸæ·»åŠ æ•°æ®

### å¤„ç†åŠŸèƒ½æµ‹è¯•

5. **test_cognify** âš ï¸
   - é”™è¯¯ï¼š500 Internal Server Error
   - ä¾èµ–ï¼šéœ€è¦å…ˆæˆåŠŸæ·»åŠ æ•°æ®

6. **test_search** âš ï¸
   - é”™è¯¯ï¼š500 Internal Server Error
   - ä¾èµ–ï¼šéœ€è¦å…ˆæˆåŠŸæ·»åŠ å’Œ cognify æ•°æ®

7. **test_get_dataset_data** âš ï¸
   - é”™è¯¯ï¼š500 Internal Server Error
   - å¯èƒ½åŸå› ï¼šæ•°æ®é›†ä¸ºç©ºæˆ–æœåŠ¡å™¨ç«¯é—®é¢˜

8. **test_get_dataset_status** âš ï¸
   - éƒ¨åˆ†é€šè¿‡ï¼ˆæ–­è¨€å¤±è´¥ï¼‰
   - å¯èƒ½åŸå› ï¼šè¿”å›æ ¼å¼ä¸é¢„æœŸä¸ç¬¦

9. **test_search_types** âš ï¸
   - é”™è¯¯ï¼š500 Internal Server Error
   - ä¾èµ–ï¼šéœ€è¦å…ˆæˆåŠŸæ·»åŠ å’Œ cognify æ•°æ®

10. **test_complete_workflow** âš ï¸
    - é”™è¯¯ï¼šå·¥ä½œæµæµ‹è¯•å¤±è´¥
    - ä¾èµ–ï¼šå¤šä¸ªåŠŸèƒ½éœ€è¦æ­£å¸¸å·¥ä½œ

11. **test_error_handling** âš ï¸
    - é”™è¯¯ï¼š500 Internal Server Error
    - å¯èƒ½åŸå› ï¼šé”™è¯¯å¤„ç†æµ‹è¯•è§¦å‘äº†æœåŠ¡å™¨é”™è¯¯

## ğŸ” é—®é¢˜åˆ†æ

### 500 é”™è¯¯å¯èƒ½çš„åŸå› 

1. **æœåŠ¡å™¨ç«¯é…ç½®é—®é¢˜**
   - æœåŠ¡å™¨å¯èƒ½æ²¡æœ‰æ­£ç¡®é…ç½®æŸäº›ç«¯ç‚¹
   - æ•°æ®åº“è¿æ¥æˆ–é…ç½®é—®é¢˜

2. **API æ ¼å¼é—®é¢˜**
   - multipart/form-data æ ¼å¼å¯èƒ½ä¸æ­£ç¡®
   - æœåŠ¡å™¨æœŸæœ›çš„å­—æ®µåæˆ–æ ¼å¼ä¸åŒ

3. **æƒé™é—®é¢˜**
   - è™½ç„¶ token æœ‰æ•ˆï¼Œä½†æŸäº›æ“ä½œå¯èƒ½éœ€è¦é¢å¤–æƒé™
   - æ•°æ®é›†æ‰€æœ‰æƒé—®é¢˜

4. **æœåŠ¡å™¨çŠ¶æ€**
   - æœåŠ¡å™¨å¯èƒ½æ­£åœ¨å¤„ç†å…¶ä»–è¯·æ±‚
   - èµ„æºé™åˆ¶æˆ–è¶…æ—¶

## ğŸ“ å»ºè®®çš„ä¸‹ä¸€æ­¥

### 1. æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿—

æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—ä»¥äº†è§£ 500 é”™è¯¯çš„å…·ä½“åŸå› ï¼š

```bash
# å¦‚æœä½¿ç”¨ Docker
docker logs <cognee-container> --tail 100

# æˆ–æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—æ–‡ä»¶
```

### 2. éªŒè¯ API ç«¯ç‚¹

ç›´æ¥ä½¿ç”¨ curl æµ‹è¯• API ç«¯ç‚¹ï¼š

```bash
# æµ‹è¯• add ç«¯ç‚¹
curl -X POST http://192.168.66.11/api/v1/add \
  -H "Authorization: Bearer <token>" \
  -F "data=test data" \
  -F "datasetName=test" \
  -v
```

### 3. æ£€æŸ¥ Swagger æ–‡æ¡£

è®¿é—® `http://192.168.66.11/api/docs` æŸ¥çœ‹ï¼š
- API ç«¯ç‚¹çš„å®é™…è¦æ±‚
- è¯·æ±‚æ ¼å¼å’Œå­—æ®µå
- å“åº”æ ¼å¼

### 4. é€æ­¥è°ƒè¯•

1. å…ˆç¡®ä¿åŸºç¡€åŠŸèƒ½ï¼ˆåˆ›å»º/åˆ é™¤æ•°æ®é›†ï¼‰æ­£å¸¸å·¥ä½œ âœ…
2. ç„¶åæµ‹è¯•ç®€å•çš„æ•°æ®æ·»åŠ 
3. é€æ­¥æµ‹è¯•æ›´å¤æ‚çš„åŠŸèƒ½

## ğŸ¯ å½“å‰æµ‹è¯•çŠ¶æ€æ€»ç»“

- **é€šè¿‡**: 4 ä¸ªåŸºç¡€æµ‹è¯•
- **å¤±è´¥**: 11 ä¸ªåŠŸèƒ½æµ‹è¯•ï¼ˆä¸»è¦æ˜¯ 500 é”™è¯¯ï¼‰
- **æµ‹è¯•è¦†ç›–ç‡**: åŸºç¡€åŠŸèƒ½å·²éªŒè¯å¯ä»¥æ­£å¸¸å·¥ä½œ

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [é›†æˆæµ‹è¯•è¯´æ˜](./INTEGRATION_TEST_README.md)
- [å¿«é€Ÿè¿è¡ŒæŒ‡å—](./RUN_INTEGRATION_TESTS.md)
- [è¿æ¥æµ‹è¯•è„šæœ¬](./test_server_connection.py)

## ğŸ”§ è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œå·²é€šè¿‡çš„æµ‹è¯•
API_URL=http://192.168.66.11 API_TOKEN=<your-token> \
  pytest -m integration tests/test_server_integration.py \
  -v --no-cov \
  -k "health_check or list_datasets or create_dataset or delete_dataset"

# è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼ˆåŒ…æ‹¬å¤±è´¥çš„ï¼‰
API_URL=http://192.168.66.11 API_TOKEN=<your-token> \
  pytest -m integration tests/test_server_integration.py \
  -v --no-cov
```

